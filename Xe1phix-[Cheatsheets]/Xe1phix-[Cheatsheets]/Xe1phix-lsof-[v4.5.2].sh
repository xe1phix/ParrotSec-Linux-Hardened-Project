#!/bin/bash
## lsof.sh
######################


##############################################################################
lsof -i -P |grep 					
##############################################################################
lsof -nPi | awk '/LISTEN/'										## Show All Listening Sockets
##############################################################################
lsof -iTCP:ssh															## Show all SSH sockets
##############################################################################
lsof -iUDP -sUDP:Idle												## idle udp sockets
##############################################################################
lsof -iTCP -sTCP:LISTEN										## listening tcp sockets
##############################################################################
lsof -Di																		## disable device cache
##############################################################################
lsof -t -i :22																## show all SSH (port 22) sockets
##############################################################################
lsof -i6																		## IPv6 only
##############################################################################
lsof TCP:25																## TCP and port 25
##############################################################################
lsof @1.2.3.4																## @ Internet IPv4 host address 1.2.3.4
##############################################################################
lsof @[3ffe:1ebc::1]:1234										## @ Internet IPv6 host address:port 1234
##############################################################################
lsof 3ffe:1ebc::1, port 1234									## Internet IPv6 host address:port 1234
##############################################################################
lsof UDP:who															## UDP who service port
##############################################################################
lsof TCP@lsof.itap:513											## TCP, @ port 513 and host name lsof.itap
##############################################################################
lsof tcp@foo:1-10,smtp,99									## TCP, @ ports 1 through 10,
##############################################################################
lsof service name smtp,										## TCP, ports 1 through smtp, host bar
port 99, host name foo tcp@bar:1-smtp
##############################################################################
lsof :time 						# either TCP, UDP or UDPLITE time service port
##############################################################################
lsof -i udp -a -u ^root
###########################################################################################
lsof -t -c sshd
###########################################################################################
lsof -a -i :22 -c /d$/
###########################################################################################
lsof -i -nlP | awk '{print $1, $8, $9}' | sort -u
###########################################################################################
lsof -a -p $pid -d txt | awk '/txt/ {print $9}' | head -1;
###########################################################################################
lsof -a -p 4107 -d txt | awk '/txt/ {print $9 " " $10}' | head -1 
###########################################################################################
lsof -nP -i | awk '/LISTEN/ {print $2 " " $7 " " $8}'
###########################################################################################
lsof -nP -i | awk '/LISTEN/ {print $2 " " $7 " " $8}' | sed -r 's/:([0-9]+)$/ \1/'
###########################################################################################
lsof -a -p $pid -d txt | awk '/txt/ {print $9}' | head -1
###########################################################################################
lsof -i | grep ":[0-9]\+->" -o | grep "[0-9]\+" -o | sort | uniq		# list out the opened ports from the current machine, use
###########################################################################################
lsof -nPi | awk '/LISTEN/ {print $1, $2, $3, $8, $9}'					## use awk to parse the output of: Process name, PID, and process owner ##
###########################################################################################
lsof -i udp:5353 -t
###########################################################################################
lsof -i udp -u root
###########################################################################################
lsof -i tcp:ssh
###########################################################################################
lsof -i tcp:22 
###########################################################################################
lsof /var/log/*
###########################################################################################
lsof -u syslog
###########################################################################################
lsof -i udp:mdns -a -u ^root
###########################################################################################
lsof ‐i ‐nlP | awk '{print $9, $8, $1}' | sed 's/.*://' | sort ‐u 
###########################################################################################
lsof +d /var/log				## See All Open Files In A Given Directory:
###########################################################################################
lsof +D /var/log
###########################################################################################
lsof -P -i -n | cut -f 1 -d " "| uniq | tail -n +2
###########################################################################################
kill -9 $(lsof -i udp:5353 -t)
###########################################################################################
while :; do kill -9 `lsof -t -i :47145`; done
###########################################################################################
kill $(lsof -t /home)
###########################################################################################
watch -n 1 lsof -nPi :47145
###########################################################################################
watch -n 1 lsof -nPi tcp:22
###########################################################################################


